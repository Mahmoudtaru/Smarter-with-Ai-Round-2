<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>كورس Smarter With AI</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Cairo -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Babel for JSX transpilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        // Set theme on initial load to prevent FOUC (Flash of Unstyled Content)
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark')
        } else {
          document.documentElement.classList.remove('dark')
        }
    </script>

    <style>
        :root {
            --bg-dark: #141c29;
            --primary-dark: #1e2d44;
            --accent-green: #92b43b;
            --accent-navy: #1e2d44;
            --text-light: #fbf9f4;
            --text-dark: #1e2d44;
            --bg-light: #fbf9f4;
            --primary-light: #ffffff;
        }

        body {
            font-family: 'Cairo', sans-serif;
            scroll-behavior: smooth;
            background-color: var(--bg-light);
        }
        
        .dark body {
            background-color: var(--bg-dark);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .animate-fadeIn { animation: fadeIn 1s ease-in-out forwards; }
        .animate-fadeInUp { animation: fadeInUp 0.8s ease-in-out forwards; }
        
        .tab-content-anim {
             animation: fadeInUp 0.5s ease-in-out;
        }

        @keyframes pulse-glow {
            0%, 100% {
                transform: scale(1.02);
                box-shadow: 0 0 8px var(--accent-green), 0 0 12px var(--accent-navy);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 16px var(--accent-green), 0 0 24px var(--accent-navy);
            }
        }
        .pulse-animate {
            animation: pulse-glow 2.2s infinite ease-in-out;
        }

        @keyframes blink-caret {
          from, to { border-color: transparent }
          50% { border-color: var(--accent-green); }
        }
        
        .typewriter-anim {
            overflow: hidden; white-space: nowrap; margin: 0 auto; letter-spacing: .05em;
            display: inline-block; /* Fixes cursor position */
            vertical-align: top; /* Ensures proper alignment */
            animation: blink-caret .75s step-end infinite; /* Re-enables blinking */
        }
        .typewriter-ltr { border-right: .15em solid var(--accent-green); }
        .typewriter-rtl { border-left: .15em solid var(--accent-green); }


        .video-container {
            position: relative; width: 100%; padding-bottom: 56.25%; /* 16:9 */
            height: 0; overflow: hidden; border-radius: 0.5rem;
        }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        .content-card {
            background-color: var(--primary-light);
            border-top: 4px solid var(--accent-navy);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .content-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(30, 45, 68, 0.1), 0 4px 6px -2px rgba(30, 45, 68, 0.05);
        }
        .dark .content-card {
            background-color: var(--primary-light);
            border-color: var(--accent-green);
            color: var(--text-dark);
        }
        .dark .content-card:hover {
             box-shadow: 0 10px 15px -3px rgba(146, 180, 59, 0.1), 0 4px 6px -2px rgba(146, 180, 59, 0.07);
        }

        .page-title {
            color: var(--accent-navy);
        }
        .dark .page-title {
            color: var(--accent-navy);
        }

        .section-header {
             color: var(--accent-navy);
        }
        .dark .section-header {
             color: var(--accent-green);
        }
        
        .subsection-title {
            background-color: var(--accent-green);
            color: var(--text-light);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
        }
        .dark .subsection-title {
            background-color: var(--accent-green);
            color: var(--accent-navy);
            font-weight: 700;
        }
        .subsection-title i {
            color: var(--text-light) !important;
        }
        .dark .subsection-title i {
            color: var(--accent-navy) !important;
        }
        
        .accordion-header[aria-expanded="true"] {
            background-color: rgba(146, 180, 59, 0.05);
        }
        .dark .accordion-header[aria-expanded="true"] {
             background-color: rgba(146, 180, 59, 0.1);
        }
        
        .bottom-nav-active { 
            color: #ffffff; 
            transform: scale(1.1); 
        }
        .bottom-nav-active > span { font-weight: 700; }

        input[type="checkbox"] {
            accent-color: var(--accent-green);
        }

        /* --- Nested Accordion Styles --- */
        .nested-accordion {
            background-color: #ffffff; /* Keep it white like the card */
            border: 1px solid #e9ecef;
            border-left: 4px solid var(--accent-green); /* Green accent border */
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
            overflow: hidden;
        }
        .nested-accordion-header {
            background-color: #f8f9fa; /* Light grey header */
            padding: 0.75rem 1rem;
            font-weight: 600;
            color: var(--accent-navy);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e9ecef; /* Separator */
        }
        .nested-accordion-header[aria-expanded="true"] {
             background-color: #f1f3f5;
        }

        .nested-accordion-content {
             max-height: 0;
             overflow: hidden;
             transition: max-height 0.3s ease-out;
             background-color: #ffffff;
             padding: 0;
        }
        .nested-accordion-content-inner {
            padding: 1rem;
            /* No top border needed, header has bottom border */
        }

    </style>
</head>
<body class="bg-bg-light dark:bg-bg-dark text-text-dark dark:text-text-light transition-colors duration-300">
    
    <div id="welcome-screen" class="fixed inset-0 bg-[#1e2d44] flex flex-col justify-center items-center z-50 transition-opacity duration-700">
        <div class="w-full flex flex-col items-center text-center">
            <img src="https://i.ibb.co/mrxY5d8z/Untitled-design-1.png" alt="Smarter With AI Logo" class="w-32 h-32 mx-auto mb-6 rounded-full bg-white p-2 shadow-lg animate-fadeIn" style="animation-delay: 0.5s;">
            <h1 id="welcome-title" dir="ltr" class="text-4xl sm:text-5xl font-bold text-[--text-light] mb-4 min-h-[56px] sm:min-h-[60px]"></h1>
            <p id="welcome-subtitle" class="text-lg sm:text-xl text-[--accent-green] mt-2 min-h-[40px] sm:min-h-[44px]"></p>
            <button id="start-btn" class="mt-12 bg-gradient-to-r from-[--accent-green] to-[--accent-navy] text-white font-bold py-3 px-10 rounded-lg text-xl transition-all transform opacity-0">
                ابدأ الآن
            </button>
        </div>
    </div>

    <div id="root" class="hidden"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef, useMemo } = React;

        // Icon.tsx
        const Icon = ({ name, className }) => {
            const wrapperRef = useRef(null);

            useEffect(() => {
                if (wrapperRef.current && window.lucide) {
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', name);
                    
                    wrapperRef.current.innerHTML = ''; 
                    wrapperRef.current.appendChild(i);
                    
                    window.lucide.createIcons({ nodes: [i] });

                    const svg = wrapperRef.current.querySelector('svg');
                    if (svg && className) {
                        className.split(' ').forEach(cls => {
                            if (cls) svg.classList.add(cls);
                        });
                    }
                }
            }, [name, className]);

            return <span ref={wrapperRef} className="inline-block" />;
        };

        // Reminder.tsx
        const Reminder = ({ children }) => {
            return (
                <div className="mb-6 p-4 border-r-4 border-[--accent-green] bg-green-50 dark:bg-slate-800 rounded-lg shadow-md flex items-start gap-4">
                    <Icon name="brain-circuit" className="w-8 h-8 text-[--accent-green] flex-shrink-0 mt-1" />
                    <div>
                        <h3 className="text-lg font-bold text-[--accent-green] mb-1">رسالة من مساعدك الذكي</h3>
                        <p className="text-gray-700 dark:text-gray-200 text-sm">{children}</p>
                    </div>
                </div>
            );
        };

        // GlobalProgressBar.tsx
        const GlobalProgressBar = ({ title, progress, completedCount, totalCount, icon }) => {
            return (
                <div className="content-card p-4 rounded-lg shadow-md">
                    <div className="flex justify-between items-center mb-2">
                        <h3 className="section-header text-lg font-bold flex items-center gap-2">
                            <Icon name={icon} />
                            <span>{title}</span>
                        </h3>
                        <span className="font-bold text-[--accent-green]">{Math.round(progress)}%</span>
                    </div>
                    <div className="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                        <div className="bg-[--accent-green] h-2.5 rounded-full transition-all duration-500" style={{ width: `${progress}%` }}></div>
                    </div>
                    <p className="text-sm text-gray-600 dark:text-gray-400 mt-2 text-center">
                        {`أكملت ${completedCount} من ${totalCount}`}
                    </p>
                </div>
            );
        };

        // Accordion.tsx
        const Accordion = ({ title, isOpen, onToggle, children, progress, isLocked }) => {
            const contentRef = useRef(null);
            const isComplete = progress === 100;

            return (
                <div className={`content-card rounded-lg overflow-hidden shadow-md ${isLocked ? 'opacity-60 bg-gray-50' : ''}`}>
                    <button
                        aria-expanded={isOpen}
                        className="accordion-header w-full text-right p-5 flex flex-col text-lg sm:text-xl font-semibold hover:bg-gray-100 dark:hover:bg-gray-100 focus:outline-none"
                        onClick={onToggle}
                        disabled={isLocked}
                    >
                        <div className="flex justify-between items-center w-full">
                            <span className="flex items-center gap-2 text-right">
                                {isLocked ? (
                                    <Icon name="lock" className="text-gray-400" />
                                ) : (
                                    isComplete && <Icon name="check-circle-2" className="text-[--accent-green]" />
                                )}
                                {title}
                            </span>
                            <Icon name={isLocked ? "lock" : "chevron-down"} className={`transition-transform duration-300 ${isOpen ? 'rotate-180' : ''} ${isLocked ? 'text-gray-400' : ''}`} />
                        </div>
                        {!isLocked && progress !== undefined && progress > 0 && (
                             <div className="w-full bg-gray-200 rounded-full h-1.5 dark:bg-gray-700 mt-3">
                                 <div className="bg-[--accent-green] h-1.5 rounded-full transition-all duration-500" style={{ width: `${progress}%` }}></div>
                             </div>
                        )}
                    </button>
                    <div
                        ref={contentRef}
                        className="accordion-content"
                        style={{ maxHeight: isOpen ? '5000px' : '0' }} // FIX: Use large fixed max-height
                    >
                        <div className="p-5 border-t border-gray-200 space-y-6">
                            {children}
                        </div>
                    </div>
                </div>
            );
        };

        // --- NEW NestedAccordion Component ---
        const NestedAccordion = ({ title, icon, isOpen, onToggle, children }) => {
            const contentRef = useRef(null);

            useEffect(() => {
                if (isOpen && window.lucide) {
                     const timeoutId = setTimeout(() => window.lucide.createIcons(), 0);
                    return () => clearTimeout(timeoutId);
                }
            }, [isOpen]);

            return (
                <div className="nested-accordion">
                    <button
                        aria-expanded={isOpen}
                        className="nested-accordion-header w-full"
                        onClick={onToggle}
                    >
                        <span className="flex items-center gap-2">
                            <Icon name={icon} className="w-5 h-5 text-[--accent-green]" />
                            <span>{title}</span>
                        </span>
                        <Icon name="chevron-down" className={`transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`} />
                    </button>
                    <div
                        ref={contentRef}
                        className="nested-accordion-content"
                        style={{ maxHeight: isOpen ? '5000px' : '0' }} // FIX: Use large fixed max-height
                    >
                        <div className="nested-accordion-content-inner text-gray-700 space-y-4">
                            {children}
                        </div>
                    </div>
                </div>
            );
        };
        // --- END NestedAccordion Component ---


        // Helper component for BonusTab links
        const RecommendationLink = ({ href, icon, title, description }) => {
            return (
                <a 
                    href={href} 
                    target="_blank" 
                    rel="noopener noreferrer" 
                    className="flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-white/10 transition-colors w-full border-b last:border-b-0"
                >
                    <Icon name={icon} className="w-5 h-5 text-[--accent-green] flex-shrink-0 mt-1" />
                    <div className="flex-grow">
                        <span className="font-semibold text-gray-800">{title}</span>
                        {description && <p className="text-sm text-gray-600">{description}</p>}
                    </div>
                    <Icon name="external-link" className="w-5 h-5 text-gray-400 flex-shrink-0 mt-1" />
                </a>
            );
        };

        // Header.tsx
        const Header = ({ theme, onThemeToggle }) => {
            return (
                <header className="bg-gradient-to-r from-[--accent-green] to-[--accent-navy] p-4 shadow-lg flex justify-between items-center sticky top-0 z-40">
                    <div className="text-center flex-grow">
                        <h1 className="text-2xl sm:text-3xl font-bold text-white tracking-wider" style={{ textShadow: '1px 1px 3px rgba(0,0,0,0.2)' }}>
                            Smarter With AI
                        </h1>
                    </div>
                    <button id="theme-toggle" onClick={onThemeToggle} className="p-2 rounded-full text-white hover:bg-white/20 transition-colors">
                        <Icon name={theme === 'dark' ? 'sun' : 'moon'} />
                    </button>
                </header>
            );
        };

        // BottomNav.tsx
        const NavButton = ({ tabId, icon, label, activeTab, onClick }) => {
            const isActive = activeTab === tabId;
            return (
                <button
                    onClick={() => onClick(tabId)}
                    className={`bottom-tab-button flex flex-col items-center gap-1 text-white/70 hover:text-white w-full p-1 transition-all duration-200 ${isActive ? 'bottom-nav-active' : ''}`}
                >
                    <Icon name={icon} className="w-6 h-6" />
                    <span className="text-xs">{label}</span>
                </button>
            );
        };

        const BottomNav = ({ activeTab, onTabChange }) => {
            const navItems = [
                { tabId: 'home', icon: 'home', label: 'الرئيسية' },
                { tabId: 'lectures', icon: 'book-open', label: 'المحاضرات' },
                { tabId: 'tasks', icon: 'clipboard-list', label: 'التاسكات' },
                { tabId: 'bonus', icon: 'gift', label: 'البونص' },
                { tabId: 'share', icon: 'heart-handshake', label: 'شاركنا' },
            ];

            return (
                <nav className="fixed bottom-0 inset-x-0 bg-gradient-to-r from-[--accent-green] to-[--accent-navy] flex justify-around p-2 z-50 shadow-t-lg">
                    {navItems.map(item => (
                        <NavButton
                            key={item.tabId}
                            tabId={item.tabId}
                            icon={item.icon}
                            label={item.label}
                            activeTab={activeTab}
                            onClick={onTabChange}
                        />
                    ))}
                </nav>
            );
        };

        // HomeTab.tsx
        const HomeTab = () => {
            // --- NEW STATE for Install Accordion ---
            const [isInstallAccordionOpen, setInstallAccordionOpen] = useState(false);
            
            useEffect(() => {
                // Ensure icons are created when accordion opens
                if (isInstallAccordionOpen && window.lucide) {
                     const timeoutId = setTimeout(() => window.lucide.createIcons(), 0);
                    return () => clearTimeout(timeoutId);
                }
            }, [isInstallAccordionOpen]);
            // --- END NEW STATE ---

            return (
                <div className="space-y-6">
                    <Reminder>
                        نصيحة هامة: الاستفادة الحقيقية من هذا الكورس تكمن في التطبيق العملي. كل محاضرة هي دعوة لك لتجربة الأدوات بنفسك ورؤية النتائج. استمتع بالرحلة!
                    </Reminder>
                    <div className="content-card p-6 rounded-lg shadow-md">
                        <h3 className="page-title text-2xl sm:text-3xl font-bold mb-4 text-center">أهلاً بك في كورس Smarter With AI!</h3>
                        <p className="text-center text-gray-700 dark:text-gray-700 mb-8">يسعدنا انضمامك إلينا في هذه الرحلة الشيقة لاستكشاف عالم الذكاء الاصطناعي وكيفية الاستفادة منه في حياتك اليومية والمهنية.</p>
                        
                        <div className="video-container shadow-lg mb-8">
                            <iframe src="https://www.youtube.com/embed/1TWllndZuFI?si=EWBxDPpfB4UEDVIN" frameBorder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowFullScreen title="فيديو تعريفي بنظام الكورس"></iframe>
                        </div>

                        <div className="grid md:grid-cols-2 gap-6 mb-6">
                           <div className="bg-white dark:bg-white p-5 rounded-xl shadow-lg transition-all hover:shadow-xl border-2 border-[--accent-green]">
                               <h4 className="section-header text-xl font-bold mb-4 flex items-center gap-2"><Icon name="info" /><span>نظام الكورس</span></h4>
                                <ul className="space-y-3 text-gray-700">
                                    <li className="flex items-start gap-3"><Icon name="check-circle-2" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span>8 أسابيع من التعلم المركز والمكثف.</span></li>
                                    <li className="flex items-start gap-3"><Icon name="check-circle-2" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span>محتوى أسبوعي: فيديوهات، أدلة، وتاسكات.</span></li>
                                    <li className="flex items-start gap-3"><Icon name="check-circle-2" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span>تعلم فعال بأحدث أدوات الذكاء الاصطناعي.</span></li>
                                    <li className="flex items-start gap-3"><Icon name="check-circle-2" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span>جروب دعم وسيشن لايف أسبوعي للمناقشة.</span></li>
                                    <li className="flex items-start gap-3"><Icon name="check-circle-2" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span>مشروع تخرج نهائي لتطبيق ما تعلمته.</span></li>
                                </ul>
                           </div>
                           <div className="bg-white dark:bg-white p-5 rounded-xl shadow-lg transition-all hover:shadow-xl border-2 border-[--accent-green]">
                                <h4 className="section-header text-xl font-bold mb-4 flex items-center gap-2"><Icon name="layout-grid" /><span>أقسام التطبيق</span></h4>
                                <ul className="space-y-3 text-gray-700">
                                     <li className="flex items-start gap-3"><Icon name="arrow-left-circle" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span><span className="font-bold">الرئيسية:</span> نظرة عامة على الكورس.</span></li>
                                     <li className="flex items-start gap-3"><Icon name="arrow-left-circle" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span><span className="font-bold">المحاضرات:</span> جميع محاضرات وأدلة الكورس.</span></li>
                                     <li className="flex items-start gap-3"><Icon name="arrow-left-circle" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span><span className="font-bold">التاسكات:</span> المهام العملية الأسبوعية.</span></li>
                                     <li className="flex items-start gap-3"><Icon name="arrow-left-circle" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span><span className="font-bold">البونص:</span> بنك أدوات ومصادر إضافية.</span></li>
                                     <li className="flex items-start gap-3"><Icon name="arrow-left-circle" className="w-5 h-5 text-[--accent-green] mt-1 flex-shrink-0" /><span><span className="font-bold">شاركنا:</span> لدعمنا ومشاركة رأيك.</span></li>
                                </ul>
                           </div>
                        </div>

                        {/* --- MODIFIED INSTALL INSTRUCTIONS --- */}
                        <Accordion
                            title="طريقة تثبيت التطبيق"
                            isOpen={isInstallAccordionOpen}
                            onToggle={() => setInstallAccordionOpen(!isInstallAccordionOpen)}
                        >
                            <div className="space-y-4 text-gray-700">
                                <div>
                                    <h5 className="font-bold text-lg mb-2 text-[--accent-green] flex items-center gap-2">
                                        <Icon name="smartphone" />
                                        <span>على الموبايل</span>
                                    </h5>
                                    <ul className="space-y-2 list-disc list-inside pr-4">
                                        <li>اضغط على الثلاث نقاط (أو زر المشاركة) في المتصفح.</li>
                                        <li>اختر "إضافة إلى الشاشة الرئيسية" (Add to Home Screen).</li>
                                        <li>أدخل اسم التطبيق ثم اضغط "إضافة" (Add).</li>
                                    </ul>
                                </div>
                                <div className="border-t pt-4">
                                    <h5 className="font-bold text-lg mb-2 text-[--accent-green] flex items-center gap-2">
                                        <Icon name="laptop" />
                                        <span>على اللابتوب</span>
                                    </h5>
                                    <ul className="space-y-2 list-disc list-inside pr-4">
                                        <li>اضغط على النجمة (★) في شريط العنوان.</li>
                                        <li>اختر "Add Bookmark" أو "إضافة إشارة مرجعية".</li>
                                    </ul>
                                </div>
                            </div>
                        </Accordion>
                       {/* --- END OF MODIFIED SECTION --- */}

                    </div>
                </div>
            );
        };

        // LecturesTab.tsx
        const lecturesData = [
            { 
                title: "الأسبوع الأول: مدخل إلى عالم الذكاء الاصطناعي والبحث", 
                lectures: [
                    { title: "مدخل لعالم الذكاء الاصطناعي", url: "https://t.me/c/2947009490/2/111" },
                    { title: "ازاي تتواصل صح", url: "https://t.me/c/2947009490/2/168" },
                    { title: "البحث في عصر الـ AI", url: "https://t.me/c/2947009490/2/169" },
                ],
                guides: [
                    { title: "مدخل لعالم الذكاء الاصطناعي", url: "https://drive.google.com/file/d/11SXSzt5_lGd4H9t2wTozYSFNVGH8AZSl/view?usp=sharing" },
                    { title: "ازاي تتواصل صح", url: "https://drive.google.com/file/d/12Oq49sJuN-vW9D5ngPoSU9uBrdZZHIDB/view?usp=sharing" },
                    { title: "الدليل الشامل لهندسة الأوامر", url: "https://drive.google.com/file/d/1LZX_nl6HVji7ECO6JtKJ_F1wJxoz7IF7/view?usp=sharing" },
                    { title: "Chatgpt كل ما تحتاج معرفته", url: "https://drive.google.com/file/d/1goaRvUC_mKWCDlNmJCeP3RivxtepEoL5/view?usp=sharing" },
                    { title: "Gemini كل ما تحتاج معرفته", url: "https://drive.google.com/file/d/1VlEvo5AA4uTznymL2tC8USlRFF4N4PAY/view?usp=sharing" },
                    { title: "البحث في عصر الـ AI", url: "https://drive.google.com/file/d/1HakdWu2ri54FMItukcKWtWyCm8OsM7_D/view?usp=sharing" },
                ]
            },
            { 
                title: "الأسبوع الثاني: المساعد الشخصي والتعلم الفعال", 
                lectures: [
                    { title: "التعلم في عصر الـ AI", url: "https://t.me/c/3281058204/5/255" },
                    { title: "انفوجرافيك وبريزنتيشن احترافية", url: "https://t.me/c/3281058204/5/270" },
                ],
                guides: [
                    { title: "التعلم في عصر الـ AI", url: "https://drive.google.com/drive/folders/17cS6wn_E9gVGV6iVgF2fyreUKmbSse2K?usp=sharing" },
                    { title: "دليل الانفوجرافيك والبريزنتيشن", url: "https://drive.google.com/drive/folders/19hdU1_8DYfYODR_NvGrQTmK264v1lh8X?usp=sharing" },
                ]
            },
            { 
                title: "الأسبوع الثالث: صناعة الصور الاحترافية", 
                lectures: [{ title: "صور احترافية", url: "https://t.me/c/3281058204/5/349" }], 
                guides: [{ title: "الدليل الشامل لعمل صور احترافية", url: "https://drive.google.com/drive/folders/1gwPV5kvIDN3p85ypQUtVeCZdIT0z1G4s?usp=sharing" }]
            },
            { 
                title: "الأسبوع الرابع: صناعة الصوت", 
                lectures: [{ title: "ازاي تعمل صوت احترافي", url: "https://t.me/c/2947009490/2/359" }], 
                guides: [{ title: "الدليل الشامل لجميع المحاضرات", url: "https://drive.google.com/file/d/1SIIryeLOx6bhbTgcSpPRufH_ETe0BjVW/view?usp=sharing" }]
            },
            { 
                title: "الأسبوع الخامس: صناعة الفيديو الاحترافي", 
                lectures: [
                    { title: "ازاي تعمل فيديوهات احترافية", url: "https://t.me/c/2947009490/2/607" },
                    { title: "تحديثات هامة حصلت الفترة اللي فاتت", url: "https://t.me/c/2947009490/2/602" },
                ], 
                guides: [
                    { title: "دليل محاضرة الفيديو", url: "https://drive.google.com/file/d/1eKKMabV-j0ELfySbmoeAFjjmMa-4feVQ/view?usp=sharing" }
                ]
            },
            { 
                title: "الأسبوع السادس: تطبيقات الذكاء الاصطناعي", 
                lectures: [
                    { title: "ازاي تحول ال cv بتاعك لموقع احترافي", url: "https://t.me/c/2947009490/2/635" },
                    { title: "ازاي تصمم مواقع وتطبيقات بمساعدة الذكاء الاصطناعي", url: "https://t.me/c/2947009490/2/648" },
                    { title: "وكلاء الذكاء الاصطناعي", url: "https://t.me/c/2947009490/2/664" }
                ], 
                guides: [
                    { title: "دليل محاضرة الـ CV", url: "https://drive.google.com/file/d/18GuMDdCAyOmyNMODDKtRjOTr2EL0VpBa/view?usp=sharing" },
                    { title: "دليل محاضرة المواقع والتطبيقات", url: "https://drive.google.com/file/d/1ArQzQ3Oe7LGFL0ukqgqpnEg_dKJq3bgL/view?usp=sharing" },
                    { title: "دعوة مجانية لـ Perplexity Pro", url: "https://pplx.ai/mahmoud18h2531" }
                ]
            },
            { title: "الأسبوع الثامن: المشروع النهائي", lectures: null, guides: null },
        ];

        const LECTURE_COMPLETION_KEY = 'lectureCompletionStatus';
        const LecturesTab = ({ setModalMessage }) => {
            const CURRENT_WEEK_INDEX = 2; // Week 1, 2, and 3 are active
            const [openWeek, setOpenWeek] = useState(lecturesData[0]?.title || null);
            const [completedLectures, setCompletedLectures] = useState(() => {
                try {
                    const saved = localStorage.getItem(LECTURE_COMPLETION_KEY);
                    return saved ? JSON.parse(saved) : {};
                } catch (error) {
                    console.error("Failed to parse lecture completion status from localStorage", error);
                    return {};
                }
            });

            useEffect(() => {
                localStorage.setItem(LECTURE_COMPLETION_KEY, JSON.stringify(completedLectures));
            }, [completedLectures]);
            
            useEffect(() => {
                if (window.lucide) {
                    const timeoutId = setTimeout(() => window.lucide.createIcons(), 0);
                    return () => clearTimeout(timeoutId);
                }
            }, [openWeek, completedLectures]);

            const handleToggleWeek = (title) => {
                setOpenWeek(prev => (prev === title ? null : title));
            };

            const handleToggleLecture = (lectureKey) => {
                setCompletedLectures(prev => ({
                    ...prev,
                    [lectureKey]: !prev[lectureKey]
                }));
            };
            
            // --- FIX 1: Recalculate progress on every render ---
            let total = 0;
            let completed = 0;
            lecturesData.forEach(week => {
                if (week.lectures) {
                    total += week.lectures.length;
                    week.lectures.forEach(lecture => {
                        if (completedLectures[`${week.title}-${lecture.title}`]) {
                            completed++;
                        }
                    });
                }
            });
            const totalLecturesCount = total;
            const totalCompletedLectures = completed;
            const overallProgress = totalLecturesCount > 0 ? (totalCompletedLectures / totalLecturesCount) * 100 : 0;
            // --- END FIX 1 ---

            const reminderText = "تذكير بنظامنا الأسبوعي: المحاضرات المسجلة متاحة لك على مدار الأسبوع. وفي نهاية كل أسبوع، نلتقي في سيشن لايف للإجابة على استفساراتك، مناقشة تطبيقات جديدة، وتعميق فهمك للمحتوى. جهّز أسئلتك!";

            return (
                <div className="space-y-6">
                    <Reminder>{reminderText}</Reminder>
                     <GlobalProgressBar 
                        title="إجمالي تقدم المحاضرات"
                        progress={overallProgress}
                        completedCount={totalCompletedLectures}
                        totalCount={totalLecturesCount}
                        icon="book-open-check"
                    />
                    <div className="space-y-4">
                        {lecturesData.map((week, index) => {
                            const isLocked = index > CURRENT_WEEK_INDEX;
                            const totalLectures = week.lectures?.length || 0;
                            const completedCount = week.lectures?.filter(l => completedLectures[`${week.title}-${l.title}`]).length || 0;
                            const progress = totalLectures > 0 ? Math.round((completedCount / totalLectures) * 100) : 0;

                            return (
                                <Accordion
                                    key={week.title}
                                    title={week.title}
                                    isOpen={!isLocked && openWeek === week.title}
                                    onToggle={() => isLocked ? setModalMessage("سيتم إضافة هذا الأسبوع قريبًا بإذن الله.") : handleToggleWeek(week.title)}
                                    progress={isLocked ? 0 : progress}
                                    isLocked={isLocked}
                                >
                                    {!isLocked ? (
                                        <div className="space-y-6">
                                            <div>
                                                <h4 className="subsection-title flex items-center gap-2"><Icon name="play-circle" /> مشاهدة المحاضرات</h4>
                                                {week.lectures && week.lectures.length > 0 ? (
                                                    <ul className="space-y-2 mt-4">
                                                        {week.lectures.map((lecture, index) => {
                                                            const lectureKey = `${week.title}-${lecture.title}`;
                                                            const isCompleted = !!completedLectures[lectureKey];
                                                            return (
                                                                <li key={index} className="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-white/10 transition-colors">
                                                                    <input
                                                                        type="checkbox"
                                                                        id={`lecture-${week.title.replace(/\s/g, '-')}-${index}`}
                                                                        checked={isCompleted}
                                                                        onChange={() => handleToggleLecture(lectureKey)}
                                                                        className="h-5 w-5 rounded border-gray-300 cursor-pointer flex-shrink-0"
                                                                    />
                                                                    <div className="flex-grow flex justify-between items-center flex-wrap gap-2">
                                                                        <label
                                                                            htmlFor={`lecture-${week.title.replace(/\s/g, '-')}-${index}`}
                                                                            className={`text-lg cursor-pointer ${isCompleted ? 'line-through text-gray-500' : ''}`}
                                                                        >
                                                                            {lecture.title}
                                                                        </label>
                                                                        <a
                                                                            href={lecture.url}
                                                                            target="_blank"
                                                                            rel="noopener noreferrer"
                                                                            className="bg-[--accent-navy] text-white text-sm px-4 py-2 rounded-lg flex items-center gap-2 hover:opacity-90 transition-all transform hover:scale-105 dark:bg-[--accent-green] dark:text-[--accent-navy] dark:font-semibold"
                                                                            aria-label={`Open lecture for ${lecture.title}`}
                                                                        >
                                                                            <Icon name="play-circle" className="w-4 h-4" />
                                                                            <span>مشاهدة</span>
                                                                        </a>
                                                                    </div>
                                                                </li>
                                                            );
                                                        })}
                                                    </ul>
                                                ) : week.title.includes("المشروع النهائي") ? (
                                                    <p className="text-gray-700 text-center p-4">
                                                        هذا الأسبوع مخصص للمشروع النهائي ولا توجد به محاضرات جديدة.
                                                    </p>
                                                ) : (
                                                    <p className="text-gray-600 text-center p-4">المحاضرة ستكون متاحة قريباً بإذن الله.</p>
                                                )}
                                            </div>
                                            
                                            {/* --- MODIFICATION: Hide Guides for Week 8 --- */}
                                            {!week.title.includes("المشروع النهائي") && (
                                                <div className="pt-6 border-t border-gray-200 dark:border-gray-700">
                                                    <h4 className="subsection-title flex items-center gap-2"><Icon name="book-text" /> أدلة الأسبوع</h4>
                                                    {week.guides && week.guides.length > 0 ? (
                                                        <ul className="space-y-2 mt-4">
                                                            {week.guides.map((guide, index) => (
                                                                <li key={index}>
                                                                    <a href={guide.url} target="_blank" rel="noopener noreferrer" className="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-white/10 transition-colors w-full">
                                                                        <Icon name={guide.title.includes("دعوة") ? "gift" : "file-text"} className="w-5 h-5 text-[--accent-green] flex-shrink-0" />
                                                                        <span className="flex-grow">{guide.title}</span>
                                                                        <Icon name="external-link" className="w-5 h-5 text-gray-400" />
                                                                    </a>
                                                                </li>
                                                            ))}
                                                        </ul>
                                                    ) : (
                                                        <p className="text-gray-600 text-center p-4">سيتم إضافته قريباً بإذن الله.</p>
                                                    )}
                                                </div>
                                            )}
                                            {/* --- END MODIFICATION --- */}

                                        </div>
                                    ) : (
                                        <></> // Render nothing if locked, onToggle handles the message
                                    )}
                                </Accordion>
                            );
                        })}
                    </div>
                </div>
            );
        };

        // TasksTab.tsx
        const tasksData = [
            { title: "تاسكات الأسبوع الأول", deadline: "21 نوفمبر 2025", tasks: ["مشاركة محادثتين مختلفين، استخدمت فيهم أوامر احترافية", "عمل بحث شامل عن موضوع انت مهتم بيه ومشاركته معانا"] },
            { title: "تاسكات الأسبوع الثاني", deadline: "28 نوفمبر 2025", tasks: ["إنشاء ومشاركة Notebook على NotebookLM لموضوع تقوم بتعلمه.", "تصميم ومشاركة انفوجرافيك واحد على الأقل أو عمل بريزنتيشن احترافية عن موضوع يخص شغلك أو دراستك"] },
            { title: "تاسكات الأسبوع الثالث", deadline: "8 ديسمبر 2025", tasks: ["عمل 3 صور على الأقل بأفكار مختلفة."] },
            { title: "تاسكات الأسبوع الرابع", deadline: "15 ديسمبر 2025", tasks: ["إنشاء ومشاركة مقطع صوتي احترافي.", "تجربة تحويل صوت إلى صوت ومشاركة المقطعين.", "تجربة استنساخ صوتك أو أي صوت آخر."] },
            { title: "تاسكات الأسبوع الخامس", deadline: "22 ديسمبر 2025", tasks: ["عمل فيديو احترافي واحد على الأقل + افاتار متكلم."] },
            { title: "تاسكات الأسبوع السادس", deadline: "29 ديسمبر 2025", tasks: ["عمل تطبيق أو موقع لفكرة أو عمل خاص بك."] },
            { title: "الأسبوع السابع: المشروع النهائي", deadline: "12 يناير 2026", tasks: ["عمل فيديو احترافي كامل (لا يقل عن 30 ثانية) مع مشاركة الأدوات المستخدمة."], isFinal: true },
        ];

        const TASK_COMPLETION_KEY = 'taskCompletionStatus';

        const TaskCard = ({ item, completedTasks, onToggleTask }) => {
            const totalTasks = item.tasks.length;
            const completedCount = item.tasks.filter(task => completedTasks[`${item.title}-${task}`]).length;
            const progress = totalTasks > 0 ? (completedCount / totalTasks) * 100 : 0;
            const isHighlighted = progress === 100 || !!item.isFinal;

            return (
                <div 
                    className="content-card p-6 rounded-lg shadow-md transition-all"
                    style={isHighlighted ? { borderTopColor: 'var(--accent-green)' } : {}}
                >
                    <h3 className="subsection-title text-xl sm:text-2xl font-bold flex items-center gap-2">
                        <Icon name={progress === 100 ? 'check-circle' : (item.isFinal ? 'award' : 'list-checks')} />
                        <span>{item.title}</span>
                    </h3>
                    
                    {totalTasks > 0 && (
                         <div className="w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700 my-4">
                             <div className="bg-[--accent-green] h-2 rounded-full transition-all duration-500" style={{ width: `${progress}%` }}></div>
                         </div>
                    )}

                    {/* --- NEW DEADLINE --- */}
                    {item.deadline && (
                        <div className="text-center mb-4 -mt-2">
                            <span className="font-bold text-red-600 text-lg flex items-center justify-center gap-2">
                                <Icon name="calendar-clock" />
                                {`الديدلاين: ${item.deadline}`}
                            </span>
                        </div>
                    )}
                    {/* --- END NEW DEADLINE --- */}

                    <ul className="space-y-4 pt-2">
                        {item.tasks.map((task, index) => {
                            const taskKey = `${item.title}-${task}`;
                            const isCompleted = !!completedTasks[taskKey];
                            return (
                                <li key={index} className="flex items-center gap-3">
                                    <input
                                        type="checkbox"
                                        id={`task-${item.title}-${index}`}
                                        checked={isCompleted}
                                        onChange={() => onToggleTask(taskKey)}
                                        className="h-5 w-5 rounded border-gray-300 cursor-pointer"
                                    />
                                    <label 
                                        htmlFor={`task-${item.title}-${index}`}
                                        className={`flex-grow cursor-pointer ${isCompleted ? 'line-through text-gray-500' : ''} ${task.includes("ضروري") ? 'font-semibold' : ''}`}
                                    >
                                       {task}
                                    </label>
                                </li>
                            )
                        })}
                    </ul>
                </div>
            );
        };

        // --- NEW LockedTaskCard Component ---
        const LockedTaskCard = ({ title, setModalMessage }) => {
            return (
                <button 
                    className="content-card p-6 rounded-lg shadow-md transition-all opacity-60 flex flex-col items-center justify-center text-center w-full hover:opacity-75"
                    onClick={() => setModalMessage("سيتم إضافة هذا الأسبوع قريبًا بإذن الله.")}
                >
                    <Icon name="lock" className="w-12 h-12 text-gray-400 mb-4" />
                    <h3 className="subsection-title text-xl sm:text-2xl font-bold !bg-gray-400 !text-white flex items-center gap-2">
                        <span>{title}</span>
                    </h3>
                    <p className="text-gray-600 font-semibold">مغلق حاليًا</p>
                </button>
            );
        };
        // --- END LockedTaskCard Component ---

        const TasksTab = ({ setModalMessage }) => {
            const CURRENT_WEEK_INDEX = 2; // Week 1 AND 2 are active
            const [completedTasks, setCompletedTasks] = useState(() => {
                try {
                    const saved = localStorage.getItem(TASK_COMPLETION_KEY);
                    return saved ? JSON.parse(saved) : {};
                } catch (error) {
                    console.error("Failed to parse task completion status from localStorage", error);
                    return {};
                }
            });

            useEffect(() => {
                localStorage.setItem(TASK_COMPLETION_KEY, JSON.stringify(completedTasks));
                 if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [completedTasks]);

            const handleToggleTask = (taskKey) => {
                setCompletedTasks(prev => ({
                    ...prev,
                    [taskKey]: !prev[taskKey]
                }));
            };

            const { totalTasksCount, totalCompletedTasks } = useMemo(() => {
                let total = 0;
                let completed = 0;
                tasksData.forEach(week => {
                    total += week.tasks.length;
                    week.tasks.forEach(task => {
                        if (completedTasks[`${week.title}-${task}`]) {
                            completed++;
                        }
                    });
                });
                return { totalTasksCount: total, totalCompletedTasks: completed };
            }, [completedTasks]);

            const overallProgress = totalTasksCount > 0 ? (totalCompletedTasks / totalTasksCount) * 100 : 0;

            const reminderText = "تذكير مهم: إنجاز التاسكات هو أساس تثبيت المعلومة. لو واجهت أي تحدي، لا تتردد في التواصل معنا على جروب التليجرام أو عبر رسالة خاصة. دعمنا لك مستمر طوال الأسبوع! 💚";

            return (
                <div className="space-y-6">
                    <Reminder>{reminderText}</Reminder>
                    <GlobalProgressBar 
                        title="إجمالي تقدم التاسكات"
                        progress={overallProgress}
                        completedCount={totalCompletedTasks}
                        totalCount={totalTasksCount}
                        icon="clipboard-check"
                    />
                    <div className="text-center">
                         <a 
                            href="https://t.me/c/3281058204/45" 
                            target="_blank" 
                            rel="noopener noreferrer"
                            className="text-white bg-gradient-to-r from-[--accent-green] to-[--accent-navy] hover:opacity-90 font-medium rounded-lg text-lg px-8 py-3 text-center transition-transform transform hover:scale-105 inline-flex items-center justify-center gap-2"
                        >
                            <Icon name="send" className="w-5 h-5"/>
                            <span>مشاركة التاسكات على جروب التليجرام</span>
                        </a>
                    </div>
                    <div className="space-y-4">
                        {tasksData.map((item, index) => (
                            index > CURRENT_WEEK_INDEX ? (
                                <LockedTaskCard key={index} title={item.title} setModalMessage={setModalMessage} />
                            ) : (
                                <TaskCard 
                                    key={index} 
                                    item={item} 
                                    completedTasks={completedTasks}
                                    onToggleTask={handleToggleTask}
                                />
                            )
                        ))}
                    </div>
                </div>
            );
        };

        // BonusTab.tsx
        const toolsData = [
            { 
                title: "استخدام يومي", 
                icon: "star", 
                tools: [
                    { name: "ChatGPT", url: "https://chat.openai.com/" },
                    { name: "Gemini", url: "https://gemini.google.com/" },
                    { name: "Copilot", url: "https://copilot.microsoft.com/" },
                    { name: "Claude", url: "https://claude.ai/" },
                    { name: "Perplexity", url: "https://www.perplexity.ai/" },
                    { name: "NotebookLM", url: "https://notebooklm.google.com/" },
                    { name: "Canva", url: "https://www.canva.com/" }
                ] 
            },
            { 
                title: "برومبت احترافي", 
                icon: "brain-circuit", 
                tools: [
                    { name: "GeneratePrompt.ai", url: "https://generateprompt.ai/" }, 
                    { name: "Image to Prompt", url: "https://imageprompt.org/image-to-prompt" },
                    { name: "Prompt Engineer (GPT)", url: "https://chatgpt.com/g/g-5XtVuRE8Y-prompt-engineer" }
                ] 
            },
            { 
                title: "صور", 
                icon: "image", 
                tools: [
                    { name: "LMArena.ai", url: "https://lmarena.ai/" },
                    { name: "Meta AI", url: "https://www.meta.ai/" },
                    { name: "Whisk", url: "https://labs.google/fx/tools/whisk?utm_source=substack&utm_medium=email" },
                    { name: "Lovart", url: "https://www.lovart.ai/home" },
                    { name: "Genspark", url: "https://www.genspark.ai/" },
                    { name: "Ideogram", url: "https://ideogram.ai/" }, 
                    { name: "Gemini", url: "https://gemini.google.com/" },
                    { name: "Copilot", url: "https://copilot.microsoft.com/" },
                ] 
            },
            { 
                title: "أوامر جاهزة للصور", 
                icon: "images", 
                tools: [
                    { name: "ChatGPT Image Art", url: "https://www.chatgptimage.art/" },
                    { name: "Banana Prompts", url: "https://www.bananaprompts.xyz/explore" },
                    { name: "Nano Banana Prompt", url: "https://nanobananaprompt.org/prompts/" }
                ] 
            },
            { 
                title: "صوت", 
                icon: "audio-lines", 
                tools: [
                    { name: "ElevenLabs", url: "https://elevenlabs.io/" }, 
                    { name: "Google AI Studio", url: "https://aistudio.google.com/" }, 
                    { name: "Lahajati", url: "https://lahajati.ai/" }, 
                    { name: "Minimax", url: "https://www.minimax.io/audio" },
                    { name: "Vocloner", url: "https://vocloner.com/" },
                    { name: "Cartesia", url: "https://play.cartesia.ai/" }
                ] 
            },
            { 
                title: "فيديو", 
                icon: "video", 
                tools: [
                    { name: "Meta AI", url: "https://www.meta.ai/" },
                    { name: "Wan", url: "https://create.wan.video/explore" },
                    { name: "Pixverse", url: "https://app.pixverse.ai/onboard" },
                    { name: "Runway", url: "https://runwayml.com/" },
                    { name: "Flow", url: "https://labs.google/fx/tools/flow/project/ce8fcb35-6af4-4e51-9971-32a76da8aeaf" },
                    { name: "Sora", url: "https://sora.com/explore" },
                    { name: "Kling", url: "https://app.klingai.com/global/video-to-lip/new" }
                ] 
            },
            { 
                title: "تعلم فعال", 
                icon: "graduation-cap", 
                tools: [
                    { name: "NotebookLM", url: "https://notebooklm.google.com/" }, 
                    { name: "ChatGPT", url: "https://chat.openai.com/" }, 
                    { name: "Perplexity", url: "https://www.perplexity.ai/" }
                ] 
            },
            { 
                title: "بريزنتيشن", 
                icon: "presentation", 
                tools: [
                    { name: "Gamma", url: "https://gamma.app/" }, 
                    { name: "Tome", url: "https://tome.app/" }, 
                    { name: "Beautiful.ai", url: "https://www.beautiful.ai/" }
                ] 
            },
            { 
                title: "وكلاء الذكاء الاصطناعي", 
                icon: "bot", 
                tools: [
                    { name: "Genspark", url: "https://www.genspark.com/" }, 
                    { name: "Skywork", url: "https://skywork.ai/" }, 
                    { name: "Manus", url: "https://manus.im/invitation/G2VVLOLCC7RPZFM" }, 
                    { name: "z.ai", url: "https://chat.z.ai/" },
                    { name: "Kimi", url: "https://www.kimi.com/" }
                ] 
            }
        ];

        const ToolCard = ({ category, isOpen, onToggle }) => {
            return (
                 <div className="content-card rounded-lg overflow-hidden shadow-md">
                    <button
                        aria-expanded={isOpen}
                        className="accordion-header w-full text-right p-5 flex items-center justify-between text-lg sm:text-xl font-semibold hover:bg-gray-100 dark:hover:bg-gray-100 focus:outline-none"
                        onClick={onToggle}
                    >
                        <span className="flex items-center gap-3">
                            <Icon name={category.icon} />
                            <span>{category.title}</span>
                        </span>
                        <Icon name="chevron-down" className={`transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`} />
                    </button>
                    <div
                        className="accordion-content"
                        style={{ maxHeight: isOpen ? '5000px' : '0' }} // FIX: Use large fixed max-height
                    >
                        <div className="p-5 border-t border-gray-200">
                            <ul className="list-disc list-inside space-y-2 pt-4 text-text-dark">
                                {category.tools.map((tool, index) => (
                                    <li key={index} className="hover:text-[--accent-green]">
                                        <a href={tool.url} target="_blank" rel="noopener noreferrer">{tool.name}</a>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    </div>
                </div>
            );
        };


        const BonusTab = () => {
            const [openAccordion, setOpenAccordion] = useState(null);
            const [openNestedAccordion, setNestedAccordion] = useState(null);
            const [openToolAccordion, setOpenToolAccordion] = useState(null);

            useEffect(() => {
              if (window.lucide) {
                const timeoutId = setTimeout(() => window.lucide.createIcons(), 0);
                return () => clearTimeout(timeoutId);
              }
            }, [openAccordion, openToolAccordion, openNestedAccordion]);

            const handleToggle = (title) => {
                setOpenAccordion(openAccordion === title ? null : title);
            };

            const handleNestedToggle = (title) => {
                setNestedAccordion(openNestedAccordion === title ? null : title);
            };

            const handleToolToggle = (title) => {
                setOpenToolAccordion(openToolAccordion === title ? null : title);
            };

            const reminderText = "ملاحظة هامة: هذا القسم متجدد باستمرار ويضم ترشيحات لأفضل الأدوات والمصادر التي أرى أنها ستضيف قيمة حقيقية لمهاراتك في العمل والدراسة. تفقده دائمًا لاكتشاف الجديد.";

            return (
                <div className="space-y-8">
                    <Reminder>{reminderText}</Reminder>
                    <div className="space-y-4">
                        <Accordion 
                            title="ترشيحاتي الخاصة" 
                            isOpen={openAccordion === "recommendations"} 
                            onToggle={() => handleToggle("recommendations")}
                        >
                            <NestedAccordion
                                title="التصميم (Canva) والمونتاج (Capcut)"
                                icon="video"
                                isOpen={openNestedAccordion === "design"}
                                onToggle={() => handleNestedToggle("design")}
                            >
                                <div className="flex flex-col rounded-lg overflow-hidden border">
                                    <RecommendationLink 
                                        href="https://t.me/HMcpa"
                                        icon="video"
                                        title="هشام مصطفي أكاديمي (كورسات مدفوعة)"
                                        description="ميزة الكورس: سعر قليل، شامل، جروب متابعة وفيدباك."
                                    />
                                    <div className="p-3 bg-gray-50 border-t">
                                        <span className="font-semibold flex items-center gap-2"><Icon name="youtube" className="w-5 h-5" /> لو عاوز حاجة مجانية (يوتيوب):</span>
                                    </div>
                                    <RecommendationLink 
                                        href="https://youtube.com/playlist?list=PLsO4nF1GHw-NRT6LoFtGm_V57wjk_nncS&si=9Oh0TcO8ViTiJ2jC"
                                        icon="play-circle"
                                        title="كورس كانفا مجاني علي اليوتيوب"
                                    />
                                    <RecommendationLink 
                                        href="https://youtu.be/bSiemfHdFtI?si=QgHBFsJO52grQ_yE"
                                        icon="play-circle"
                                        title="Capcut يوتيوب (للكمبيوتر)"
                                    />
                                    <RecommendationLink 
                                        href="https://youtube.com/playlist?list=PLs-hceiryD_hjBCEDQMdCRPAhaR8Xemye&si=1NKlVSQ3DZp7kIys"
                                        icon="play-circle"
                                        title="Capcut علي الهاتف"
                                    />
                                </div>
                            </NestedAccordion>

                            <NestedAccordion
                                title="كتابة محتوى (Content Writing)"
                                icon="book-copy"
                                isOpen={openNestedAccordion === "content"}
                                onToggle={() => handleNestedToggle("content")}
                            >
                                <div className="flex flex-col rounded-lg overflow-hidden border">
                                    <RecommendationLink 
                                        href="https://www.facebook.com/share/p/1EfMGRNcqa/"
                                        icon="book-copy"
                                        title="ترشيحات مجانية ومدفوعة"
                                        description="بوست شامل لأفضل مصادر تعلم كتابة المحتوى"
                                    />
                                </div>
                            </NestedAccordion>
                            
                            <NestedAccordion
                                title="ميديا باينج (إعلانات ممولة)"
                                icon="dollar-sign"
                                isOpen={openNestedAccordion === "media"}
                                onToggle={() => handleNestedToggle("media")}
                            >
                                <div className="flex flex-col rounded-lg overflow-hidden border">
                                    <RecommendationLink 
                                        href="https://www.facebook.com/share/p/19uhZmBKuu/"
                                        icon="dollar-sign"
                                        title="افضل الكورسات المتاحة"
                                        description="بوست يجمع أفضل كورسات الإعلانات الممولة"
                                    />
                                </div>
                            </NestedAccordion>

                            <NestedAccordion
                                title="Digital Marketing"
                                icon="briefcase"
                                isOpen={openNestedAccordion === "marketing"}
                                onToggle={() => handleNestedToggle("marketing")}
                            >
                                <div className="flex flex-col rounded-lg overflow-hidden border">
                                    <RecommendationLink 
                                        href="https://t.me/matrixmena/1000"
                                        icon="briefcase"
                                        title="Digital marketing workshop"
                                        description="ورشة عمل في التسويق الرقمي"
                                    />
                                    <RecommendationLink 
                                        href="https://youtube.com/playlist?list=PLxe78bIBB8nVGSQbYw6MLKfWuNQmnjKdh&si=7s5NGI-gn7CVgqT-"
                                        icon="youtube"
                                        title="كورس التسويق الالكتروني بمساعدة الذكاء الاصطناعي"
                                    />
                                </div>
                            </NestedAccordion>

                            <NestedAccordion
                                title="لتعلم الأتمتة (Automation)"
                                icon="repeat"
                                isOpen={openNestedAccordion === "automation"}
                                onToggle={() => handleNestedToggle("automation")}
                            >
                                <div className="flex flex-col rounded-lg overflow-hidden border">
                                    <RecommendationLink 
                                        href="https://youtu.be/9bMy9C8wIyg?si=WuUN5xmThiWDfgvO"
                                        icon="play-circle"
                                        title="مقدمة عن الأتمتة (فيديو)"
                                    />
                                     <RecommendationLink 
                                        href="https://www.facebook.com/share/p/1B7G57H4KS/"
                                        icon="file-text"
                                        title="الأتمتة وأنواعها وخارطة الطريق"
                                    />
                                     <RecommendationLink 
                                        href="https://www.facebook.com/share/p/17aTwCbtsA/"
                                        icon="map"
                                        title="خارطة الطريق لتعلمها"
                                    />
                                    <div className="p-3 bg-gray-50 border-t">
                                        <div className="flex items-center gap-3">
                                            <Icon name="list-checks" className="w-5 h-5 text-[--accent-green] flex-shrink-0" />
                                            <span className="flex-grow font-semibold">أفضل مصادر مجانية لتعلم n8n (بدون برمجة):</span>
                                        </div>
                                    </div>
                                    <RecommendationLink 
                                        href="https://youtube.com/playlist?list=PLLHIYYlcgk6KN58UnPm8q1btNHLDJlYto&si=DFh8wDJR0dyBD1mT"
                                        icon="youtube"
                                        title="n8n with Karim (Playlist)"
                                    />
                                    <RecommendationLink 
                                        href="https://youtube.com/playlist?list=PLZ42ZUInDWC79Bw1K_tYQhUPfFRV7fy8v&si=YAq1RH85DUo7l-Ak"
                                        icon="youtube"
                                        title="احترف Agentic AI Engineering (Playlist)"
                                    />
                                </div>
                            </NestedAccordion>

                        </Accordion>

                         <Accordion 
                            title="مساعدين شخصيين (GPTs)" 
                            isOpen={openAccordion === "assistants"} 
                            onToggle={() => handleToggle("assistants")}
                        >
                            <ul className="space-y-2 mt-4 text-gray-700">
                                <li>
                                    <a href="https://t.me/c/2947009490/2/652" target="_blank" rel="noopener noreferrer" className="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-white/10 transition-colors w-full">
                                        <Icon name="play-circle" className="w-5 h-5 text-[--accent-green] flex-shrink-0" />
                                        <span className="flex-grow">المساعدون الشخصيون (المحاضرة)</span>
                                        <Icon name="external-link" className="w-5 h-5 text-gray-400" />
                                    </a>
                                </li>
                                <li>
                                    <a href="https://mahmoudtaru.github.io/Smarter-Gifts/" target="_blank" rel="noopener noreferrer" className="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-white/10 transition-colors w-full">
                                        <Icon name="link" className="w-5 h-5 text-[--accent-green] flex-shrink-0" />
                                        <span className="flex-grow">الرابط بتاعهم (قائمة المساعدين)</span>
                                        <Icon name="external-link" className="w-5 h-5 text-gray-400" />
                                    </a>
                                </li>
                            </ul>
                        </Accordion>
                        
                         <Accordion 
                            title="مصادر إضافية للتعلم" 
                            isOpen={openAccordion === "resources"} 
                            onToggle={() => handleToggle("resources")}
                        >
                            <NestedAccordion
                                title="أفضل صفحات لمتابعة محتوى AI"
                                icon="users"
                                isOpen={openNestedAccordion === "follow"}
                                onToggle={() => handleNestedToggle("follow")}
                            >
                                <div className="space-y-3 pt-2">
                                    <a href="https://drive.google.com/file/d/1qeKaJ8vr8gmBNCR-QLTmLgqXJPcKhFcs/view?usp=sharing" target="_blank" rel="noopener noreferrer" className="hover:text-[--accent-green] flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50">
                                        <Icon name="youtube" className="w-5 h-5 text-red-600" />
                                        <span>يوتيوب</span>
                                    </a>
                                    <a href="https://drive.google.com/file/d/1dtRwvwG4B3SqlFgEBxD1zLM8iRWlE8vX/view?usp=sharing" target="_blank" rel="noopener noreferrer" className="hover:text-[--accent-green] flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50">
                                        <Icon name="facebook" className="w-5 h-5 text-blue-600" />
                                        <span>فيسبوك</span>
                                    </a>
                                    <a href="https://drive.google.com/file/d/1lOOh_34fP9g8lsiYQtS8WGm1j59evVil/view?usp=sharing" target="_blank" rel="noopener noreferrer" className="hover:text-[--accent-green] flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50">
                                        <Icon name="twitter" className="w-5 h-5 text-blue-400" />
                                        <span>تويتر (X)</span>
                                    </a>
                                </div>
                            </NestedAccordion>
                            
                            <NestedAccordion
                                title="بودكاست عن الذكاء الاصطناعي"
                                icon="podcast"
                                isOpen={openNestedAccordion === "podcast"}
                                onToggle={() => handleNestedToggle("podcast")}
                            >
                                <div className="flex flex-col rounded-lg overflow-hidden border">
                                    <RecommendationLink 
                                        href="https://youtu.be/7WvKcFsAj6E?si=R0CQAof252pcSUtx"
                                        icon="podcast"
                                        title="بودكاست محمد جودت عن حقيقة الـ AI"
                                        description="بتكلمك عن الذكاء الاصطناعي ،، ايه هو ،، بدأ ازاي ،،اللي وصلناله ،، رايحين لفين..."
                                    />
                                    <RecommendationLink 
                                        href="https://youtu.be/UsODl3Ay0CM?si=ZXGslETVO7EZ-YLP"
                                        icon="podcast"
                                        title="بودكاست تطور الذكاء الاصطناعي واغتنام الفرص"
                                    />
                                    <RecommendationLink 
                                        href="https://youtu.be/WjpPDYibONU?si=dN-7w9To4yaKKUxX"
                                        icon="podcast"
                                        title="دور العرب في طفرة الذكاء الاصطناعي"
                                    />
                                </div>
                            </NestedAccordion>

                        </Accordion>
                    </div>
                    
                    <div>
                        <h2 className="subsection-title text-2xl sm:text-3xl font-bold mb-6 text-center">بنك أدوات الذكاء الاصطناعي</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {toolsData.map((category, index) => (
                                <ToolCard 
                                    key={index} 
                                    category={category} 
                                    isOpen={openToolAccordion === category.title}
                                    onToggle={() => handleToolToggle(category.title)}
                                />
                            ))}
                        </div>
                    </div>
                </div>
            );
        };


        // ShareTab.tsx
        const ShareTab = () => {
            return (
                <div className="space-y-6">
                    <Reminder>
                        رسالة شكر: رحلتنا معكم ممتعة، وبكم نكبر ونتطور. رأيك يساهم في تحسين الكورس، ودعوتك لأصدقائك توسّع مجتمعنا. هدفنا أن نصبح جميعًا Smarter With AI.
                    </Reminder>
                    <div className="content-card p-8 rounded-lg shadow-md max-w-2xl mx-auto text-center">
                        <Icon name="gift" className="w-16 h-16 mx-auto text-[--accent-green]" />
                        <h2 className="page-title text-2xl sm:text-3xl font-bold text-center my-4">شارك الكورس مع أحبابك!</h2>
                        <p className="text-gray-700 mb-2">لأننا مبسوطين بوجودك معانا، نحب نشاركك الفرصة دي عشان أصحابك وحبايبك ينضموا لينا.</p>
                        <p className="text-gray-700 font-semibold mb-6">احصل على كود دعوة خاص بيك يدي خصم يصل إلى 40% لأي حد من طرفك (تقدر تستخدمه مع 5 أشخاص).</p>
                        <p className="text-gray-700 mb-8">خليك انت وحبايبك Smarter With AI! 💚</p>
                        <a href="https://www.facebook.com/messages/t/675407645657010" target="_blank" rel="noopener noreferrer" className="text-white bg-gradient-to-r from-[--accent-green] to-[--accent-navy] hover:opacity-90 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-lg w-full sm:w-auto px-8 py-3 text-center transition-transform transform hover:scale-105 inline-flex items-center justify-center gap-2">
                            <Icon name="message-circle" />
                            <span>اطلب كود الدعوة الخاص بيك</span>
                        </a>
                    </div>
                    <div className="content-card p-8 rounded-lg shadow-md max-w-2xl mx-auto text-center">
                        <h2 className="page-title text-2xl sm:text-3xl font-bold text-center mb-6">نحن نهتم برأيك!</h2>
                        <p className="text-center text-gray-700 mb-8">مشاركتك تساعدنا على تحسين وتطوير الكورس. اضغط على الزر أدناه لترك رأيك.</p>
                        <a 
                            href="https://forms.gle/BFpPvB4yLQT8uQH66" 
                            target="_blank" 
                            rel="noopener noreferrer"
                            className="text-white bg-gradient-to-r from-[--accent-green] to-[--accent-navy] hover:opacity-90 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-lg w-full sm:w-auto px-8 py-3 text-center transition-transform transform hover:scale-105 inline-flex items-center justify-center gap-2"
                        >
                            <Icon name="file-text" />
                            <span>شاركنا رأيك الآن</span>
                        </a>
                    </div>
                </div>
            );
        };

        // App.tsx
        const App = () => {
            const [theme, setTheme] = useState('light');
            const [activeTab, setActiveTab] = useState('home');
            const [modalMessage, setModalMessage] = useState(null); 

            useEffect(() => {
                const storedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const initialTheme = storedTheme === 'dark' || (!storedTheme && prefersDark) ? 'dark' : 'light';
                setTheme(initialTheme);
            }, []);

            useEffect(() => {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                localStorage.setItem('theme', theme);
            }, [theme]);
            
            useEffect(() => {
                if (window.lucide) {
                    const timeoutId = setTimeout(() => window.lucide.createIcons(), 0);
                    return () => clearTimeout(timeoutId);
                }
            }, [activeTab, modalMessage]); // Add modalMessage to re-render icons

            const handleThemeToggle = () => {
                setTheme(prevTheme => prevTheme === 'light' ? 'dark' : 'light');
            };

            const handleTabChange = useCallback((tabId) => {
                setActiveTab(tabId);
                window.scrollTo(0, 0);
            }, []);

            const renderContent = () => {
                switch (activeTab) {
                    case 'home': return <HomeTab />;
                    case 'lectures': return <LecturesTab setModalMessage={setModalMessage} />;
                    case 'tasks': return <TasksTab setModalMessage={setModalMessage} />;
                    case 'bonus': return <BonusTab />;
                    case 'share': return <ShareTab />;
                    default: return <HomeTab />;
                }
            };

            return (
                <div id="app-content">
                    {/* --- NEW MODAL --- */}
                    {modalMessage && (
                        <div 
                            className="fixed inset-0 bg-black/60 flex items-center justify-center z-[999] p-4" 
                            onClick={() => setModalMessage(null)}
                        >
                            <div 
                                className="bg-white p-6 rounded-lg shadow-lg text-center w-full max-w-sm" 
                                onClick={(e) => e.stopPropagation()}
                            >
                                <Icon name="lock" className="w-16 h-16 text-[--accent-green] mx-auto mb-4" />
                                <h3 className="text-xl font-bold mb-2 text-gray-800">محتوى مغلق</h3>
                                <p className="text-gray-700 mb-6">{modalMessage}</p>
                                <button 
                                    onClick={() => setModalMessage(null)} 
                                    className="bg-gradient-to-r from-[--accent-green] to-[--accent-navy] text-white font-bold py-2 px-8 rounded-lg text-lg transition-all transform hover:scale-105"
                                >
                                    حسنًا
                                </button>
                            </div>
                        </div>
                    )}
                    {/* --- END NEW MODAL --- */}

                    <Header theme={theme} onThemeToggle={handleThemeToggle} />
                    <main className="container mx-auto p-4 md:p-8 pb-24">
                        <div className="tab-content-anim">
                            {renderContent()}
                        </div>
                    </main>
                    <BottomNav activeTab={activeTab} onTabChange={handleTabChange} />
                </div>
            );
        };

        // Rendering logic
        const rootElement = document.getElementById('root');
        const root = ReactDOM.createRoot(rootElement);
        root.render(
            <App />
        );
    </script>
    <script>
        // Welcome Screen Logic
        function setupWelcomeScreen() {
            const welcomeScreen = document.getElementById('welcome-screen');
            const appContent = document.getElementById('root'); // Target the root div for React
            const startBtn = document.getElementById('start-btn');
            const titleEl = document.getElementById('welcome-title');
            const subtitleEl = document.getElementById('welcome-subtitle');
            
            const titleText = "Smarter With AI";
            const subtitleText = "مبسوطين انك في الكورس معانا 💚";

            function applyTypewriter(element, text, speed, direction, callback) {
                let i = 0; element.innerHTML = "";
                
                // Add cursor class
                element.classList.add('typewriter-anim', (direction === 'ltr' ? 'typewriter-ltr' : 'typewriter-rtl'));
                
                function type() {
                    if (i < text.length) { 
                        element.innerHTML += text.charAt(i); 
                        i++; 
                        setTimeout(type, speed); 
                    } else { 
                        // Cursor blink should continue, but remove the border from style
                        setTimeout(() => {
                            // Stop animation and remove border class
                             element.classList.remove('typewriter-anim', 'typewriter-ltr', 'typewriter-rtl');
                             element.style.borderRight = 'none'; 
                             element.style.borderLeft = 'none';
                            if (callback) callback();
                        }, 500); 
                    }
                }
                type();
            }

            setTimeout(() => {
                applyTypewriter(titleEl, titleText, 100, 'ltr', () => {
                    setTimeout(() => {
                        applyTypewriter(subtitleEl, subtitleText, 75, 'rtl', () => {
                            setTimeout(() => {
                                startBtn.classList.remove('opacity-0');
                                startBtn.classList.add('animate-fadeInUp', 'pulse-animate');
                            }, 500);
                        });
                    }, 300);
                });
            }, 1500);

            startBtn.addEventListener('click', () => {
                welcomeScreen.classList.add('opacity-0');
                setTimeout(() => {
                    welcomeScreen.style.display = 'none';
                    if (appContent) {
                       appContent.classList.remove('hidden'); 
                    }
                    if (window.lucide) {
                        window.lucide.createIcons();
                    }
                }, 700);
            });
        }

        // Initialize the welcome screen logic
        document.addEventListener('DOMContentLoaded', () => {
            setupWelcomeScreen();
        });
    </script>
</body>
</html>
